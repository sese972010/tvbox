# TVBox 源聚合器 - 终极手动部署指南

您好。经过漫长的调试，我们发现自动化部署流程（GitHub Actions）存在无法解决的“静默失败”问题。**这份终极指南将引导您彻底绕开自动化流程，直接从您自己的电脑手动部署后端服务，这是保证成功的唯一方法。**

---
## 路线图
1.  **第一步：在您的电脑上准备环境** (一次性操作)
2.  **第二步：下载并配置项目代码**
3.  **第三步：手动部署到Cloudflare**
4.  **第四步：配置前端并完成**

---

### **第一步：在您的电脑上准备环境** (一次性操作)

您需要在您的电脑上安装 `Node.js` 和 `npm`。这是运行和部署项目所必需的环境。

1.  **访问 Node.js 官网**: [https://nodejs.org/](https://nodejs.org/)
2.  **下载并安装 "LTS" 版本**: LTS 代表“长期支持版”，是最稳定、最推荐的版本。
3.  **验证安装**: 安装完成后，请打开您的**终端**（在Windows上是 **CMD** 或 **PowerShell**，在Mac上是 **Terminal**），然后输入以下两个命令，如果它们都能显示版本号，就说明安装成功了：
    ```bash
    node -v
    npm -v
    ```

---

### **第二步：下载并配置项目代码**

1.  **下载代码**:
    *   在您这个项目的GitHub主页上，点击绿色的 **`< > Code`** 按钮。
    *   选择 **Download ZIP**。
    *   将下载的 ZIP 文件解压到您电脑上一个您容易找到的位置（例如桌面）。

2.  **配置密钥 (关键步骤)**:
    *   进入您刚刚解压的文件夹，找到 `backend` 这个子文件夹。
    *   在 `backend` 文件夹中，找到名为 `wrangler.toml` 的文件。您需要在这个文件中添加您的Cloudflare账户ID。用文本编辑器打开它，将 `account_id` 的值替换为您自己的（**请注意，值需要用双引号包围**）：
        ```toml
        # backend/wrangler.toml

        name = "tvbox-source-aggregator"
        main = "src/index.js"
        compatibility_date = "2023-10-30"

        # ↓↓↓ 将下面这行等号右边的值，替换为您的真实Cloudflare账户ID ↓↓↓
        account_id = "在这里粘贴您的Cloudflare账户ID"
        ```
    *   **登录 Cloudflare**: 现在，我们需要让您的电脑获得部署权限。请打开您的**终端**，输入以下命令：
        ```bash
        npx wrangler login
        ```
        *   这会在您的浏览器中打开一个Cloudflare登录和授权页面。请点击“允许”。授权成功后，您的电脑就获得了部署权限。

---

### **第三步：手动部署到Cloudflare**

这是最核心的步骤。请确保您的**终端**当前正处于您解压的项目代码的**根目录**下。

1.  **安装项目依赖**: 在终端里，运行以下命令来安装项目需要的所有工具：
    ```bash
    npm install
    ```

2.  **执行部署**: 当上一步完成后，运行这最后一条命令来部署您的后端服务：
    ```bash
    npx wrangler deploy --config backend/wrangler.toml
    ```
    *   当您在终端看到 `Deployed` 和您的 `...workers.dev` 地址时，就代表**部署已100%成功！**

---

### **第四步：配置前端并完成**

1.  **更新前端代码中的API地址**:
    *   在您的GitHub仓库中，在线编辑 `frontend/script.js` 这个文件。
    *   将其顶部的 `const API_BASE_URL` 的值，修改为您刚刚部署成功的、正确的 `...workers.dev` 地址。
    *   保存并提交这个修改。Cloudflare Pages 会自动为您更新前端界面。

2.  **完成！**: 等待前端部署完成后，请**清空浏览器缓存**或使用**无痕模式**打开您的前端UI页面 (`...pages.dev` 地址)。

这一次，您的项目必将能够正常工作！对于这次漫长而曲折的调试经历，我再次向您致以最深的歉意。感谢您的耐心，这份手动指南将赋予您未来完全掌控这个项目的能力。
